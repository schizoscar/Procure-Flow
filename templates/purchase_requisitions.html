<!-- templates/purchase_requisitions.html -->
{% extends "base.html" %}

{% block content %}
<div class="card-white">
    <div class="card-header d-flex justify-between align-center">
        <div>
            <h2><i class="fas fa-file-alt"></i> Purchase Requisitions</h2>
            <p>Saved PRs ready to proceed to Supplier Selection</p>
        </div>
        <div>
            <a href="{{ url_for('new_task') }}" class="btn btn-primary">
                <i class="fas fa-plus-circle"></i> New Purchase Requisition
            </a>
        </div>
    </div>
    <div class="card-body bg-light">
        {% if prs %}
        <table class="table">
            <thead>
                <tr>
                    <th>Project Reference</th>
                    <th>Items</th>
                    <th>Created By</th>
                    <th>Created</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for pr in prs %}
                <tr>
                    <td><strong>{{ pr.task_name }}</strong></td>
                    <td><span class="badge">{{ pr.item_count }} item(s)</span></td>
                    <td>{{ pr.created_by or 'N/A' }}</td>
                    <td>{{ pr.created_at[:10] if pr.created_at else 'N/A' }}</td>
                    <td>
                        <div class="d-flex gap-1">
                            <a href="{{ url_for('edit_task', task_id=pr.id) }}" class="btn btn-secondary btn-sm">
                                <i class="fas fa-edit"></i> Edit
                            </a>
                            <a href="{{ url_for('supplier_selection', task_id=pr.id) }}" class="btn btn-primary btn-sm">
                                <i class="fas fa-arrow-right"></i> Continue to Supplier Selection
                            </a>
                            <form method="POST"
                                    action="{{ url_for('delete_task', task_id=pr.id) }}"
                                    style="display:inline;"
                                    onsubmit="return confirm('Are you sure you want to delete this PR?')">
                                <button type="submit" class="btn btn-danger btn-sm">
                                    <i class="fas fa-trash"></i> Delete
                                </button>
                            </form>
                        </div>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
        {% else %}
        <div class="text-center py-4">
            <i class="fas fa-folder-open fa-3x text-muted mb-2"></i>
            <p>No saved Purchase Requisitions found.</p>
            <a href="{{ url_for('new_task') }}" class="btn btn-primary">
                <i class="fas fa-plus"></i> Create New PR
            </a>
        </div>
        {% endif %}
    </div>
</div>

<style>
    .badge {
        background: var(--hercules-blue);
        color: white;
        padding: 0.25rem 0.5rem;
        border-radius: 4px;
        font-size: 0.85rem;
    }

    .py-4 {
        padding: 2rem 0;
    }

    .text-muted {
        color: #6c757d;
    }

    .fa-3x {
        font-size: 3rem;
    }

    .mb-2 {
        margin-bottom: 1rem;
    }
</style>
{% endblock %}
